setwd("C:/Users/MMKONDIWA/OneDrive - CIMMYT/Documents/GitHub/where_to_put_agroecology/models/Crop_Suitability")
sink("C:/Users/MMKONDIWA/OneDrive - CIMMYT/Documents/GitHub/where_to_put_agroecology/models/Crop_Suitability/console.txt", append=FALSE)
##########################################################################################
#
#     ~ ~ ~ Simple Yield Model (SYM) ~ ~ ~
#     ~ ~ ~ this is just a toy model ~ ~ ~
#     ~ ~ ~ Input data ~ ~ ~
#    land_use.asc        |land use map containing the following classes
#                        |1,2,3,4,5 = arable land with increasing intensity from 1 to 5
#                   
#
#    soil_fertility.asc  |map on soil fertility which can range from 0.1 to 1
#
#    Objective: Maximize crop yield
#
##########################################################################################

# set working directory

# read in ascii files
lu.map <- read.table("map.asc", h=F, skip=6, sep=" ")
suit.map_1_5 <- read.table("r_suit_1_5.asc", h = F, skip = 6, sep = " ")
suit.map_6_10 <- read.table("r_suit_6_10.asc", h = F, skip = 6, sep = " ")

# array index for arable land
arable.idx <- which(lu.map <= 10 & lu.map > 0, arr.ind=T)
arable.idx1 <- which(lu.map <= 5 & lu.map > 0, arr.ind = T)
arable.idx2 <- which(lu.map <= 10 & lu.map > 5, arr.ind = T)

# calculate crop yield as logarithmic function of intensity and soil fertility
yield_1 <- lu.map[arable.idx1]*suit.map_1_5[arable.idx1] 
yield_2 <- lu.map[arable.idx2]*suit.map_6_10[arable.idx2] 

yield_1[is.na(yield_1)] <- 0
yield_1.sum <- sum(yield_1)

yield_2[is.na(yield_2)] <- 0
yield_2.sum <- sum(yield_2)

#yield.sum <- yield_1.sum + yield_2.sum

yield <- lu.map[arable.idx]
yield[is.na(yield)] <- 0

yield.sum <- sum (yield)

# write model output
write.table(yield.sum , "CSM_output.csv",append=FALSE ,sep =";",col.names=FALSE ,row.names=FALSE)

















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































sink()
